% LaTeX preamble for dissertation PDF build

\usepackage{newunicodechar}
\newunicodechar{â†’}{\ensuremath{\rightarrow}}

\usepackage{polyglossia}
\setmainlanguage{slovak}

% --- Typography & Layout ---
\usepackage{microtype}
\usepackage{xevlna} % Fix single letter prepositions
\usepackage{enumitem}
\setlist{nosep}
\raggedbottom

% --- Fonts ---
\usepackage{fontspec}

% Main font configuration
\setmainfont{Setup Serif}[
  UprightFont = *,
  BoldFont = SetupSerif-Medium,
  ItalicFont = SetupSerif-RegularItalic,
  BoldItalicFont = SetupSerif-MediumItalic, % Fallback for bold italic
]

\setsansfont{Async Sans}
\setmonofont{Menlo}[Scale=0.9]

% Helper for Medium weight (used in headings)
\newfontfamily\fontMedium{SetupSerif-Medium}

% --- Headings ---
\usepackage{titlesec}

% Chapter: Huge, Medium
\titleformat{\chapter}[display]
  {\fontMedium\huge}
  {\thechapter}{20pt}{\Huge}

% Section: Large, Medium
\titleformat{\section}
  {\fontMedium\Large}
  {\thesection}{1em}{}

% Subsection: Normalsize, Medium
\titleformat{\subsection}
  {\fontMedium\large}
  {\thesubsection}{1em}{}

% --- Figures & Captions ---
\usepackage{caption}
\usepackage{placeins}
\usepackage{graphicx}

\captionsetup{
  font={small,stretch=1.1},
  labelfont={bf},       % Bold label (e.g. Figure 1)
  labelsep=quad,        % Space after label
  justification=raggedright,
  singlelinecheck=false,
  margin=0pt
}

% Default image settings
\setkeys{Gin}{width=\linewidth, height=0.75\textheight, keepaspectratio}

% --- Boxes (Aside & Quote) ---
\usepackage[most]{tcolorbox}
\usepackage{etoolbox}

% Quote: Minimalist left bar
\renewenvironment{quote}{%
  \begin{tcolorbox}[
    blanker,
    borderline west={1pt}{0pt}{black}, % Thin line on left
    left=1.5em,
    before skip=1em,
    after skip=1em,
    fontupper=\small
  ]
}{\end{tcolorbox}}
\renewenvironment{quotation}{\begin{quote}}{\end{quote}}

% Aside: Clean top/bottom lines, no background
\newtcolorbox{aside}{
  enhanced,
  breakable,
  frame hidden,        % No frame
  colback=white,       % White background
  toprule=0.5pt,       % Top line
  bottomrule=0.5pt,    % Bottom line
  sharp corners,
  left=0pt, right=0pt,
  top=1em, bottom=1em,
  before skip=1.5em, after skip=1.5em,
  fonttitle=\fontMedium,
  coltitle=black,
  attach title to upper={\par\medskip}
}

% Handle figures inside Aside environments
\AtBeginEnvironment{aside}{
  \FloatBarrier
  \renewenvironment{figure}[1][]{
    \center
    \captionsetup{type=figure}
  }{\endcenter}
}
\AfterEndEnvironment{aside}{\FloatBarrier}

\usepackage{url}
\def\UrlBreaks{\do\/\do-}

\usepackage{tikz}
\usetikzlibrary{positioning, arrows.meta, shapes, calc}
